<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Level Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../src/lib/angular-material/angular-material.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body ng-app="app" layout="column">
    <script src="../src/lib/angular/angular.min.js"></script>
    <script src="../src/lib/angular-animate/angular-animate.min.js"></script>
    <script src="../src/lib/angular-aria/angular-aria.min.js"></script>
    <script src="../src/lib/angular-messages/angular-messages.min.js"></script>
    <script src="../src/lib/angular-material/angular-material.min.js"></script>
    <script type="text/javascript">
        var levels = '';
        function define(junk, data) {
            levels = data();
            console.log(levels);
        }
    </script>
    <script src="../src/level-data.js"></script>
    <script src="app.js"></script>
    <div ng-controller="mainCtrl" layout-padding  layout="column" flex ng-mouseup="update.drawEnd()">
        <div layout="row">
            <div class="tool {{tool.name}}" ng-repeat="tool in tools" ng-class="{selected:activeTool==tool.name}" ng-click="setTool(tool.name)">
                <i class="fa fa-{{tool.icon}}" ng-if="tool.icon"></i>
            </div>
            <div flex></div>
            <div>
                <md-button class="md-raised md-primary" ng-click="save()">
                    save
                </md-button>
            </div>
        </div>
        <md-content flex>
            <md-button class="md-raised md-primary" ng-click="add.level(levels, 0)">
                <i class="fa fa-plus"></i>
                add level
            </md-button>
            <div class="level" ng-repeat="level in levels" >
                <h3>Level: {{$index}}</h3>
                <md-input-container>
                    <label>MaxSpawn</label>
                    <input type="number" ng-model="level.maxSpawns">
                </md-input-container>

                <md-button class="md-raised md-accent" ng-click="add.pattern(level, 0)">
                    <i class="fa fa-plus"></i>
                    add pattern
                </md-button>
                <div class="pattern" md-inset ng-repeat="pattern in level.patterns" >
                    <h3>Pattern: {{$parent.$index}}.{{$index}}</h3>

                    <md-button class="md-raised md-accent" ng-click="add.set(pattern, 0)">
                        <i class="fa fa-plus"></i>
                        add set
                    </md-button>
                    <md-content class="set" md-inset ng-repeat="set in pattern.sets track by $index" ng-init="set.lanes=setLength(set.lanes)" layout-padding>
                        <div class="lane" layout="row" ng-repeat="lane in set.lanes track by $index">
                            <div class="co {{field.key}}" ng-repeat="field in lane track by $index"

                                 ng-mousedown="update.drawStart($event); update.draw(lane,$index);"
                                 ng-mouseover="update.draw(lane,$index)"></div>
                        </div>
                        <md-button class="md-warn md-raised" ng-click="delete.set($parent.pattern, $index)">
                            <i class="fa fa-minus"></i>
                            remove set
                        </md-button>
                        <md-button class="md-raised md-accent" ng-click="add.set($parent.pattern, $index+1)">
                            <i class="fa fa-plus"></i>
                            add set
                        </md-button>
                    </md-content>
                    <md-button class="md-warn md-raised" ng-click="delete.pattern($parent.level, $index)">
                        <i class="fa fa-minus"></i>
                        remove pattern
                    </md-button>
                    <md-button class="md-raised md-accent" ng-click="add.pattern($parent.level, $index+1)">
                        <i class="fa fa-plus"></i>
                        add pattern
                    </md-button>
                    <md-divider md-inset></md-divider>
                </div>
                <md-button class="md-raised md-primary" ng-click="delete.level($parent.levels, $index)">
                    <i class="fa fa-minus"></i>
                    remove level
                </md-button>
                <md-button class="md-raised md-primary" ng-click="add.level($parent.levels, $index+1)">
                    <i class="fa fa-plus"></i>
                    add level
                </md-button>
                <md-divider></md-divider>
            </div>
        </md-content>

    </div>
    <style>
        .lane{
            padding: 0;
        }
        .co{
            height: 80px;
            width: 50px;
            border-top: 1px dotted;
            border-right: 1px dotted;
            border-bottom: 1px dotted;
            overflow: hidden;
            background: url(img/ground.png) center;
        }
        .tool{
            border: 4px solid #999999;
            height: 80px;
            width: 50px;
            cursor: pointer;
        }
        .selected{
            background-color: rgba(0,0,0,.25);
            border: 4px solid rgb(255,64,129);
        }
        .token{
            background: url(img/token.png) center;
        }
        .power-up{
            background: url(img/power-up.png) center;
        }
        .scaffolding{
            background: url(img/scaffolding.png) center;
        }
        .wheel{
            background: url(img/wheel.png) center;
        }
        .rock{
            background: url(img/rock.png) center;
        }
    </style>
</body>
</html>